from kafka import KafkaProducer
import uuid, json
from time import sleep

producer = KafkaProducer(bootstrap_servers=["broker:9092"], api_version=(0, 10, 1))
pulses = [
  "602bc528f447d628d41494f2",
  "617b089bbbab1cd42903ced7"
]

def json_serializer(data):
  return json.dumps(data).encode("utf-8")

def get_and_send_pulse(generated_id):
  indicators = [
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3366317331, 'indicator': '62.0.119.136', 'type': 'IPv4', 'created': '2022-12-02 06:31:08', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 32, 'longitude': 34, 'accuracy_radius': 20, 'url_list_length': 2, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3467415388, 'indicator': '1.34.232.120', 'type': 'IPv4', 'created': '2022-12-02 06:31:08', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 24, 'longitude': 121, 'accuracy_radius': 20, 'url_list_length': 2, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3366317331, 'indicator': '62.0.119.136', 'type': 'IPv4', 'created': '2022-12-02 06:31:09', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 32, 'longitude': 34, 'accuracy_radius': 20, 'url_list_length': 2, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3467415388, 'indicator': '1.34.232.120', 'type': 'IPv4', 'created': '2022-12-02 06:31:09', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 24, 'longitude': 121, 'accuracy_radius': 20, 'url_list_length': 2, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3366317331, 'indicator': '62.0.119.136', 'type': 'IPv4', 'created': '2022-12-02 06:31:10', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 32, 'longitude': 34, 'accuracy_radius': 20, 'url_list_length': 2, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3581552183, 'indicator': '202.137.220.97', 'type': 'IPv4', 'created': '2022-12-02 06:31:45', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 20, 'longitude': 77, 'accuracy_radius': 1000, 'url_list_length': 2, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3366317331, 'indicator': '62.0.119.136', 'type': 'IPv4', 'created': '2022-12-02 06:31:45', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 32, 'longitude': 34, 'accuracy_radius': 20, 'url_list_length': 2, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3470324600, 'indicator': '31.220.1.83', 'type': 'IPv4', 'created': '2022-12-02 06:32:17', 'content': '', 'title': 'telnet bruteforce attack (Lu)', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 51, 'longitude': 9, 'accuracy_radius': 200, 'url_list_length': 9, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3581552183, 'indicator': '202.137.220.97', 'type': 'IPv4', 'created': '2022-12-02 06:32:17', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 20, 'longitude': 77, 'accuracy_radius': 1000, 'url_list_length': 2, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 2118591535, 'indicator': '193.105.134.95', 'type': 'IPv4', 'created': '2022-12-02 06:32:49', 'content': '', 'title': 'ssh bruteforce attack (Lu)', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 54, 'longitude': -4, 'accuracy_radius': 50, 'url_list_length': 7, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3470324600, 'indicator': '31.220.1.83', 'type': 'IPv4', 'created': '2022-12-02 06:32:50', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 51, 'longitude': 9, 'accuracy_radius': 200, 'url_list_length': 9, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3577223707, 'indicator': '110.182.210.119', 'type': 'IPv4', 'created': '2022-12-02 06:32:51', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 36, 'longitude': 111, 'accuracy_radius': 10, 'url_list_length': 2, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3577787770, 'indicator': '123.175.153.171', 'type': 'IPv4', 'created': '2022-12-02 06:33:22', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 34, 'longitude': 113, 'accuracy_radius': 1000, 'url_list_length': 2, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3577223707, 'indicator': '110.182.210.119', 'type': 'IPv4', 'created': '2022-12-02 06:33:23', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 36, 'longitude': 111, 'accuracy_radius': 10, 'url_list_length': 2, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3307531357, 'indicator': '31.220.3.140', 'type': 'IPv4', 'created': '2022-12-02 06:34:01', 'content': '', 'title': 'telnet bruteforce attack (Lu)', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 51, 'longitude': 9, 'accuracy_radius': 200, 'url_list_length': 10, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3455986336, 'indicator': '60.249.91.240', 'type': 'IPv4', 'created': '2022-12-02 06:34:34', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 24, 'longitude': 120, 'accuracy_radius': 20, 'url_list_length': 5, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3576038636, 'indicator': '114.228.233.183', 'type': 'IPv4', 'created': '2022-12-02 06:35:07', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 31, 'longitude': 119, 'accuracy_radius': 200, 'url_list_length': 2, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3445650785, 'indicator': '46.229.134.81', 'type': 'IPv4', 'created': '2022-12-02 06:35:39', 'content': '', 'title': 'ssh bruteforce attack (Lu)', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 56, 'longitude': 60, 'accuracy_radius': 500, 'url_list_length': 2, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3434361074, 'indicator': '196.1.198.173', 'type': 'IPv4', 'created': '2022-12-02 06:36:12', 'content': '', 'title': 'ssh bruteforce attack (Lu)', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 15, 'longitude': 30, 'accuracy_radius': 50, 'url_list_length': 3, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3581530878, 'indicator': '34.105.240.52', 'type': 'IPv4', 'created': '2022-12-02 06:36:43', 'content': '', 'title': 'ssh bruteforce attack (Lu)', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 51, 'longitude': 0, 'accuracy_radius': 1000, 'url_list_length': 2, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3307531357, 'indicator': '31.220.3.140', 'type': 'IPv4', 'created': '2022-12-02 06:36:44', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 51, 'longitude': 9, 'accuracy_radius': 200, 'url_list_length': 10, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 2971408099, 'indicator': '88.168.109.186', 'type': 'IPv4', 'created': '2022-12-02 06:37:18', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 48, 'longitude': 2, 'accuracy_radius': 1, 'url_list_length': 4, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3438218323, 'indicator': '45.184.71.115', 'type': 'IPv4', 'created': '2022-12-02 06:37:50', 'content': '', 'title': 'telnet bruteforce attack (Lu)', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': -15, 'longitude': -47, 'accuracy_radius': 10, 'url_list_length': 2, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3473470585, 'indicator': '220.134.153.121', 'type': 'IPv4', 'created': '2022-12-02 06:38:23', 'content': '', 'title': 'Telnet Login attempt', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 23, 'longitude': 120, 'accuracy_radius': 10, 'url_list_length': 5, 'pulse_id': generated_id},
    {'pulse_key': '602bc528f447d628d41494f2', 'id': 3581503707, 'indicator': '35.245.13.151', 'type': 'IPv4', 'created': '2022-12-02 06:38:59', 'content': '', 'title': 'ssh bruteforce attack (Lu)', 'description': '', 'expiration': '2022-12-02T09:00:00', 'is_active': 1, 'false_positive': {'assessment': None, 'assessment_date': None, 'report_date': None}, 'slug': 'ip', 'latitude': 38, 'longitude': -77, 'accuracy_radius': 1000, 'url_list_length': 2, 'pulse_id': generated_id}
  ]

  print("Pulse acquired.")

  for data in indicators:
    producer.send('alienvaultdata', json_serializer(data))
    sleep(1)

    print("\nSent: ", data)

for pulse in pulses:
  generated_id = str(uuid.uuid1())
  get_and_send_pulse(generated_id)
